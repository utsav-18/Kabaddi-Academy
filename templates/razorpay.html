<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Kabaddi Academy — Test Payment</title>
  <style>
    body{font-family:Arial,system-ui;display:flex;align-items:center;justify-content:center;
      min-height:100vh;background:#f4f4f6;margin:0;padding:20px}
    .card{width:380px;background:#fff;padding:22px;border-radius:12px;box-shadow:0 8px 30px rgba(2,6,23,0.08)}
    h2{margin:0 0 12px;font-size:20px}
    input{width:100%;padding:10px;margin:8px 0;border-radius:6px;border:1px solid #ddd;font-size:15px}
    button{width:100%;padding:12px;border-radius:8px;border:0;background:#facc15;color:#111;font-weight:700;cursor:pointer}
    .note{font-size:13px;color:#666;margin-top:10px}
  </style>
</head>
<body>
  <div class="card">
    <h2>Kabaddi Academy — Admission (₹1)</h2>

    <input id="name" type="text" placeholder="Full name" required />
    <input id="email" type="email" placeholder="Email" required />
    <input id="phone" type="tel" placeholder="Phone (10 digits)" required />

    <button id="payBtn">Pay ₹1 & Register</button>

    <p class="note">Test mode enabled — use card 4111 1111 1111 1111 (any future expiry, CVV 123)</p>
    <p class="note">After payment this page will POST data to your Google Apps Script URL.</p>
  </div>

  <!-- Razorpay Checkout -->
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script>
    const payBtn = document.getElementById('payBtn');

    payBtn.addEventListener('click', async () => {
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();

      if (!name || !email || !phone) {
        alert('Please fill all fields.');
        return;
      }

      const options = {
        key: "rzp_test_XbnqrIC7Y9cJV0", // your provided test key
        amount: 1000, // ₹99 in paise
        currency: "INR",
        name: "KVS Kabaddi Academy",
        description: "Admission Fee",
        image: "", // optional logo URL - e.g. "kvslogo.jpeg"
        prefill: {
          name: name,
          email: email,
          contact: phone
        },
        theme: { color: "#FACC15" },
        handler: function (response) {
          // Payment successful — send details to Google Apps Script
          const gsUrl = "https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec"; // <-- REPLACE THIS
          const payload = {
            timestamp: new Date().toISOString(),
            name: name,
            email: email,
            phone: phone,
            amount: 1,
            payment_id: response.razorpay_payment_id
          };

          fetch(gsUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(payload)
          })
          .then(r => r.text())
          .then(txt => {
            alert("Payment success! Registration saved.");
            // Optionally redirect:
            // window.location.href = "thankyou.html";
          })
          .catch(err => {
            console.error(err);
            alert("Payment succeeded but saving failed. Check console.");
          });
        },
        modal: { ondismiss: function() { console.log("Checkout closed"); } }
      };

      const rzp = new Razorpay(options);
      rzp.open();
    });
  </script>
  <script src="raorpay.js"></script>
</body>
</html>